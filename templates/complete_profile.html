<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSOL KZ - å®Œå–„ä¸ªäººä¿¡æ¯</title>
    <link rel="stylesheet" href="{{ static_url(filename='style.css') }}">
</head>
<body>
    <div class="complete-profile-container">
        <div class="logo">
            <h1>CSOL KZ</h1>
            <p>åœ°å›¾ç®¡ç†å¹³å° - å®Œå–„ä¸ªäººä¿¡æ¯</p>
        </div>
        
        <!-- æ¶ˆæ¯æç¤º -->
        <div class="flash-messages">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="flash-message {{ category }}">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            {% endwith %}
        </div>
        
        <div class="welcome-text">æ¬¢è¿åŠ å…¥ï¼</div>
        <div class="subtitle">è¯·å®Œå–„æ‚¨çš„ä¸ªäººä¿¡æ¯</div>
        
        <!-- å®Œå–„ä¸ªäººä¿¡æ¯è¡¨å• -->
        <form method="POST" action="{{ url_for('auth.complete_profile') }}" id="completeProfileForm">
            <!-- å¤´åƒé€‰æ‹© -->
            <div class="avatar-section">
                <label class="form-group">
                    <span style="color: #eee; font-weight: 500; display: block; margin-bottom: 8px; text-align: left;">é€‰æ‹©å¤´åƒ</span>
                    <div class="avatar-grid">
                        <div class="avatar-option" data-avatar="avatar1.png" style="background-image: url('{{ url_for('static', filename='avatars/avatar1.png') }}')"></div>
                        <div class="avatar-option" data-avatar="avatar2.png" style="background-image: url('{{ url_for('static', filename='avatars/avatar2.png') }}')"></div>
                        <div class="avatar-option" data-avatar="avatar3.png" style="background-image: url('{{ url_for('static', filename='avatars/avatar3.png') }}')"></div>
                        <div class="avatar-option" data-avatar="avatar4.png" style="background-image: url('{{ url_for('static', filename='avatars/avatar4.png') }}')"></div>
                        <div class="avatar-option" data-avatar="avatar5.png" style="background-image: url('{{ url_for('static', filename='avatars/avatar5.png') }}')"></div>
                        <div class="avatar-option" data-avatar="avatar6.png" style="background-image: url('{{ url_for('static', filename='avatars/avatar6.png') }}')"></div>
                        <div class="avatar-option" data-avatar="avatar7.png" style="background-image: url('{{ url_for('static', filename='avatars/avatar7.png') }}')"></div>
                        <div class="avatar-option" data-avatar="avatar8.png" style="background-image: url('{{ url_for('static', filename='avatars/avatar8.png') }}')"></div>
                    </div>
                    <input type="hidden" name="avatar" id="selectedAvatar" value="avatar1.png">
                </label>
            </div>
            
            <!-- æ¸¸æˆæ˜µç§° -->
            <div class="form-group">
                <label for="nickname">æ¸¸æˆæ˜µç§°</label>
                <input type="text" id="nickname" name="nickname" required placeholder="è¯·è¾“å…¥æ‚¨çš„æ¸¸æˆæ˜µç§°">
                <div class="nickname-tip">ğŸ’¡ æç¤ºï¼š1ä¸ªæœˆåªèƒ½ä¿®æ”¹3æ¬¡</div>
                <div class="error-message" id="nickname-error"></div>
            </div>
            
            <button type="submit" class="register-btn" id="completeBtn">å®Œæˆè®¾ç½®</button>
        </form>
    </div>
    
    <script>
        // å¤´åƒé€‰æ‹©é€»è¾‘
        const avatarOptions = document.querySelectorAll('.avatar-option');
        const selectedAvatarInput = document.getElementById('selectedAvatar');
        
        avatarOptions.forEach(option => {
            option.addEventListener('click', function() {
                // ç§»é™¤å…¶ä»–é€‰ä¸­çŠ¶æ€
                avatarOptions.forEach(opt => opt.classList.remove('selected'));
                // æ·»åŠ å½“å‰é€‰ä¸­çŠ¶æ€
                this.classList.add('selected');
                // æ›´æ–°éšè—è¾“å…¥æ¡†çš„å€¼
                selectedAvatarInput.value = this.dataset.avatar;
            });
        });
        
        // é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªå¤´åƒ
        avatarOptions[0].classList.add('selected');
        
        // æ˜µç§°éªŒè¯
        const nickname = document.getElementById('nickname');
        const nicknameError = document.getElementById('nickname-error');
        const completeBtn = document.getElementById('completeBtn');
        
        nickname.addEventListener('input', function() {
            const value = this.value.trim();
            
            if (!value) {
                this.classList.add('error');
                this.classList.remove('success');
                nicknameError.textContent = 'è¯·è¾“å…¥æ¸¸æˆæ˜µç§°';
                nicknameError.style.display = 'block';
            } else if (value.length > 50) {
                this.classList.add('error');
                this.classList.remove('success');
                nicknameError.textContent = 'æ˜µç§°ä¸èƒ½è¶…è¿‡50ä¸ªå­—ç¬¦';
                nicknameError.style.display = 'block';
            } else {
                this.classList.remove('error');
                this.classList.add('success');
                nicknameError.style.display = 'none';
            }
            
            validateForm();
        });
        
        function validateForm() {
            const nicknameValid = nickname.classList.contains('success');
            if (nicknameValid) {
                completeBtn.disabled = false;
            } else {
                completeBtn.disabled = true;
            }
        }
        
        // è¡¨å•æäº¤éªŒè¯
        document.getElementById('completeProfileForm').addEventListener('submit', function(e) {
            if (completeBtn.disabled) {
                e.preventDefault();
                alert('è¯·å®Œå–„æ‰€æœ‰å¿…å¡«é¡¹');
            }
        });
        
        // é¡µé¢åŠ è½½æ—¶èšç„¦åˆ°æ˜µç§°è¾“å…¥æ¡†
        window.addEventListener('load', function() {
            nickname.focus();
        });
    </script>
</body>
</html> 